<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽ“ PDUSU EDUCATION</title>
<style>
  :root{--bg:#f8fafc;--card:#fff;--muted:#475569;--accent:#2563eb}
  body{font-family:Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a}
  header{display:flex;align-items:center;gap:12px;background:#fff;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,.08);position:relative}
  header img{height:60px;cursor:pointer}
  header h1{margin:0;font-size:22px}
  header p{margin:0;font-size:14px;color:var(--muted)}
  nav{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;padding:15px;background:#e2e8f0}
  button, .btn{padding:10px 20px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer;transition:.15s}
  button:hover,.btn:hover{background:#1e40af}
  .content{padding:20px;max-width:980px;margin:0 auto}
  .semester{display:none;animation:fade .25s ease}
  @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
  .class-card{background:var(--card);border-radius:10px;padding:14px;box-shadow:0 1px 5px rgba(0,0,0,.07);margin-bottom:12px}
  .class-card h3{margin:0 0 6px 0}
  .class-card a{color:var(--accent);text-decoration:none}
  footer{text-align:center;padding:20px;background:#e2e8f0;color:var(--muted);font-size:14px}
  /* Admin modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:50}
  .modal{background:#fff;border-radius:10px;padding:18px;width:90%;max-width:520px;box-shadow:0 8px 30px rgba(2,6,23,.2)}
  label{display:block;margin-top:8px;font-size:14px}
  input[type="text"],select,input[type="url"]{width:100%;padding:10px;border:1px solid #e6e9ef;border-radius:8px;margin-top:6px}
  .admin-controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .danger{background:#ef4444}
  .small{font-size:13px;padding:8px 10px;border-radius:6px}
  .note{color:#6b7280;font-size:13px;margin-top:8px}
</style>
</head>
<body>

<header>
  <img id="logo" src="PDUSU-logo.png" alt="PDUSU Logo" onerror="this.style.opacity='.25'">
  <div>
    <h1>ðŸŽ“ PDUSU EDUCATION</h1>
    <p>Pandit Deendayal Upadhyaya Shekhawati University, Sikar</p>
  </div>
</header>

<nav>
  <button onclick="showSemester(1)">Semester 1</button>
  <button onclick="showSemester(2)">Semester 2</button>
  <button onclick="showSemester(3)">Semester 3</button>
  <button onclick="showSemester(4)">Semester 4</button>
  <button onclick="showSemester(5)">Semester 5</button>
  <button onclick="showSemester(6)">Semester 6</button>
  <button onclick="openPasswordPrompt()" style="background:#ef4444;">Admin</button> <!-- Visible admin button -->
</nav>

<div class="content">
  <!-- Semester containers -->
  <div id="sem1" class="semester"><h2>ðŸ“˜ Semester 1</h2><div class="semester-list"></div></div>
  <div id="sem2" class="semester"><h2>ðŸ“— Semester 2</h2><div class="semester-list"></div></div>
  <div id="sem3" class="semester"><h2>ðŸ“™ Semester 3</h2><div class="semester-list"></div></div>
  <div id="sem4" class="semester"><h2>ðŸ“’ Semester 4</h2><div class="semester-list"></div></div>
  <div id="sem5" class="semester"><h2>ðŸ“• Semester 5</h2><div class="semester-list"></div></div>
  <div id="sem6" class="semester"><h2>ðŸ“š Semester 6</h2><div class="semester-list"></div></div>
</div>

<footer>Â© 2025 PDUSU EDUCATION | Designed for University Students by Giriraj pareek </footer>

<!-- Admin modal -->
<div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
  <div class="modal" role="document">
    <div id="modalContent"></div>
  </div>
</div>

<script>
const PASSWORD_SHA256 = "8abf09e0892662c4b8945de98ac87f804fdf1bc1e8545ecebb570683a68b4928";
const STORAGE_KEY = "pdusu_classes_v1";

// ---------- Helpers ----------
async function sha256Hex(input){
  const enc = new TextEncoder();
  const data = enc.encode(input);
  const hash = await crypto.subtle.digest('SHA-256', data);
  return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2,'0')).join('');
}

function loadClasses(){ return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]"); }
function saveClasses(list){ localStorage.setItem(STORAGE_KEY, JSON.stringify(list)); }

function renderAll(){
  const classes = loadClasses();
  for(let s=1;s<=6;s++){
    const container = document.querySelector("#sem"+s+" .semester-list");
    container.innerHTML = "";
    const items = classes.filter(c=>c.semester===s).sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));
    if(items.length===0){ container.innerHTML="<p class='note'>Classes will be added soon...</p>"; continue; }
    items.forEach(it=>{
      const card=document.createElement("div");
      card.className="class-card";
      card.innerHTML=`
        <h3>${escapeHtml(it.class_name)}</h3>
        <p><a href="${escapeAttr(it.youtube_link)}" target="_blank">â–¶ Watch on YouTube</a></p>
        <p><a href="${escapeAttr(it.pdf_url)}" target="_blank">ðŸ“„ Download Notes (PDF)</a></p>
      `;
      container.appendChild(card);
    });
  }
}

function showSemester(n){
  document.querySelectorAll(".semester").forEach(s=>s.style.display="none");
  document.getElementById("sem"+n).style.display="block";
}
showSemester(1);
renderAll();

// ---------- Admin ----------
const modalBackdrop=document.getElementById("modalBackdrop");
const modalContent=document.getElementById("modalContent");

function openPasswordPrompt(){
  const pwd = prompt("Enter Admin Password:");
  if(!pwd) return;
  sha256Hex(pwd).then(hash=>{
    if(hash===PASSWORD_SHA256){ openAdminPanel(); }
    else{ alert("Incorrect password"); }
  });
}

function openAdminPanel(){
  const classes=loadClasses();
  let listHtml="";
  if(classes.length===0) listHtml="<p class='note'>No classes yet.</p>";
  else{
    listHtml='<div style="max-height:220px;overflow:auto;margin-top:8px">';
    classes.slice().reverse().forEach(c=>{
      listHtml+=`
        <div style="padding:8px;border-bottom:1px solid #eef2f7">
          <strong>Sem ${c.semester}</strong> â€” ${escapeHtml(c.class_name)}<br>
          <small><a href="${escapeAttr(c.youtube_link)}" target="_blank">YouTube</a> Â· <a href="${escapeAttr(c.pdf_url)}" target="_blank">PDF</a></small>
          <div style="margin-top:6px">
            <button class="small" onclick="editClass('${c.id}')">Edit</button>
            <button class="small danger" onclick="deleteClass('${c.id}')">Delete</button>
          </div>
        </div>
      `;
    });
    listHtml+="</div>";
  }

  showModal(`
    <h3>Admin Panel</h3>
    <form id="adminForm" onsubmit="return false;">
      <label>Semester
        <select id="admSemester">
          <option value="1">Semester 1</option>
          <option value="2">Semester 2</option>
          <option value="3">Semester 3</option>
          <option value="4">Semester 4</option>
          <option value="5">Semester 5</option>
          <option value="6">Semester 6</option>
        </select>
      </label>
      <label>Class Name
        <input id="admClassName" type="text" placeholder="Economics Basics" required>
      </label>
      <label>YouTube Link
        <input id="admYouTube" type="url" placeholder="https://www.youtube.com/watch?v=..." required>
      </label>
      <label>PDF URL
        <input id="admPdfUrl" type="url" placeholder="https://example.com/notes/economics.pdf" required>
      </label>
      <div class="admin-controls">
        <button class="btn" onclick="saveNewClass()">Add / Save</button>
        <button class="small" onclick="closeModal()">Close</button>
      </div>
    </form>
    <hr>
    <h4>Existing classes</h4>
    ${listHtml}
    <div style="margin-top:8px"><button class="small danger" onclick="wipeData()">Wipe all local data</button></div>
  `);
}

// Modal helpers
function showModal(html){ modalContent.innerHTML=html; modalBackdrop.style.display="flex"; }
function closeModal(){ modalBackdrop.style.display="none"; }

function saveNewClass(){
  const sem=parseInt(document.getElementById("admSemester").value);
  const name=document.getElementById("admClassName").value.trim();
  const yt=document.getElementById("admYouTube").value.trim();
  const pdf=document.getElementById("admPdfUrl").value.trim();
  if(!name||!yt||!pdf){ alert("Please fill all fields"); return; }
  const list=loadClasses();
  list.push({
    id: crypto.randomUUID ? crypto.randomUUID() : 'id_'+Date.now(),
    semester: sem,
    class_name: name,
    youtube_link: yt,
    pdf_url: pdf,
    created_at: new Date().toISOString()
  });
  saveClasses(list);
  renderAll();
  alert("Saved");
  openAdminPanel();
}

function editClass(id){
  const list=loadClasses();
  const c=list.find(x=>x.id===id); if(!c) return alert("Not found");
  showModal(`
    <h3>Edit Class</h3>
    <form id="adminForm" onsubmit="return false;">
      <label>Semester
        <select id="admSemester">
          <option ${c.semester===1?'selected':''} value="1">Semester 1</option>
          <option ${c.semester===2?'selected':''} value="2">Semester 2</option>
          <option ${c.semester===3?'selected':''} value="3">Semester 3</option>
          <option ${c.semester===4?'selected':''} value="4">Semester 4</option>
          <option ${c.semester===5?'selected':''} value="5">Semester 5</option>
          <option ${c.semester===6?'selected':''} value="6">Semester 6</option>
        </select>
      </label>
      <label>Class Name
        <input id="admClassName" type="text" value="${escapeAttr(c.class_name)}" required>
      </label>
      <label>YouTube Link
        <input id="admYouTube" type="url" value="${escapeAttr(c.youtube_link)}" required>
      </label>
      <label>PDF URL
        <input id="admPdfUrl" type="url" value="${escapeAttr(c.pdf_url)}" required>
      </label>
      <div class="admin-controls">
        <button class="btn" onclick="saveEditedClass('${c.id}')">Save</button>
        <button class="small" onclick="openAdminPanel()">Cancel</button>
      </div>
    </form>
  `);
}

function saveEditedClass(id){
  const sem=parseInt(document.getElementById("admSemester").value);
  const name=document.getElementById("admClassName").value.trim();
  const yt=document.getElementById("admYouTube").value.trim();
  const pdf=document.getElementById("admPdfUrl").value.trim();
  if(!name||!yt||!pdf){ alert("Please fill all fields"); return; }
  const list=loadClasses();
  const idx=list.findIndex(x=>x.id===id);
  if(idx>=0){
    list[idx].semester=sem; list[idx].class_name=name; list[idx].youtube_link=yt; list[idx].pdf_url=pdf;
    list[idx].created_at=new Date().toISOString();
  }
  saveClasses(list); renderAll(); openAdminPanel(); alert("Updated");
}

function deleteClass(id){
  if(!confirm("Delete this class?")) return;
  let list=loadClasses();
  list=list.filter(x=>x.id!==id);
  saveClasses(list);
  renderAll();
  openAdminPanel();
}

function wipeData(){
  if(confirm("Remove ALL local classes? This cannot be undone.")){
    localStorage.removeItem(STORAGE_KEY);
    renderAll();
    openAdminPanel();
  }
}

// Escape helpers
function escapeHtml(s){ return String(s).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function escapeAttr(s){ return String(s).replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }
</script>
</body>
</html>
