<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üéì PDUSU EDUCATION</title>
<meta name="theme-color" content="#2563eb" />
<style>
:root{
  --bg:#f8fafc;--text:#0f172a;--card:#fff;--muted:#475569;--accent:#2563eb;--glass:rgba(255,255,255,0.6);
}
[data-theme="dark"]{--bg:#0b1220;--text:#e6eef8;--card:#0f1724;--muted:#94a3b8;--accent:#3b82f6;--glass:rgba(255,255,255,0.03)}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
header{display:flex;justify-content:space-between;align-items:center;padding:18px 22px;background:linear-gradient(90deg,#6366f1,#ec4899,#f59e0b);color:#fff}
.header-left{display:flex;gap:14px;align-items:center}
#logo{width:80px;height:80px;border-radius:10px;background:#fff;padding:6px;cursor:pointer;object-fit:cover;box-shadow:0 6px 18px rgba(0,0,0,0.12)}
.header-title h1{margin:0;font-size:20px}
.header-title p{margin:4px 0 0 0;font-size:13px;opacity:.95}
.theme-toggle{background:rgba(255,255,255,0.95);color:var(--accent);border:none;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:700}
.main-wrap{width:95%;max-width:1200px;margin:20px auto;display:flex;gap:20px;flex-wrap:wrap;align-items:flex-start}
.sidebar{width:240px;min-width:200px;background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.06)}
.sidebar h3{margin:0 0 8px 0}
.link{display:block;text-align:center;background:var(--accent);color:#fff;padding:10px;border-radius:8px;margin:8px 0;text-decoration:none;font-weight:700}
.content{flex:1;min-width:300px}
.top-cards{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
.card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.06);flex:1;min-width:220px}
.card h3{margin:0 0 8px 0;color:var(--accent)}
.semester-list{display:flex;gap:8px;flex-wrap:wrap}
.sem-btn{padding:8px 12px;border-radius:8px;border:none;background:#f1f5f9;color:var(--text);cursor:pointer;font-weight:700}
.sem-btn:hover{background:rgba(37,99,235,0.08)}
.note{font-size:13px;color:var(--muted);margin-top:8px}
.table-wrap{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.06);overflow:auto}
table{width:100%;border-collapse:collapse;font-size:14px}
thead th{position:sticky;top:0;background:var(--card);padding:10px;text-align:left;border-bottom:1px solid rgba(0,0,0,0.06)}
tbody td{padding:10px;border-bottom:1px solid rgba(0,0,0,0.04)}
.btn{padding:8px 10px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
.btn-primary{background:var(--accent);color:#fff}
.btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;z-index:200}
.modal{background:var(--card);width:92%;max-width:720px;border-radius:12px;padding:18px;box-shadow:0 20px 60px rgba(2,6,23,0.4);max-height:86vh;overflow:auto}
@media(max-width:900px){.main-wrap{padding:0 12px}.sidebar{width:100%}.top-cards{flex-direction:column}}
</style>
</head>
<body>

<header>
  <div class="header-left">
    <img id="logo" src="PDUSU-logo.png" alt="PDUSU Logo">
    <div class="header-title">
      <h1>üéì PDUSU EDUCATION</h1>
      <p>‡§Æ‡•á‡§π‡§®‡§§ ‡§π‡•Ä ‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§π‡•à ‚Äî ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§§‡•á ‡§∞‡§π‡•ã, ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã!</p>
    </div>
  </div>
  <div>
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">üåû Light</button>
  </div>
</header>

<main class="main-wrap">
  <aside class="sidebar" aria-label="Useful links">
    <h3>‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§≤‡§ø‡§Ç‡§ï‡•ç‡§∏</h3>
    <a class="link" href="https://shekhauniexam.in/" target="_blank" rel="noopener">üìÑ Result</a>
    <a class="link" href="https://shekhauni.ac.in/Home/Syllabus" target="_blank" rel="noopener">üìò Syllabus</a>
    <a class="link" href="https://shekhauni.ac.in/Home/Examination" target="_blank" rel="noopener">üì∞ University News</a>
    <a class="link" href="https://www.youtube.com/" target="_blank" rel="noopener">‚ñ∂Ô∏è YouTube</a>
  </aside>

  <section class="content" aria-live="polite">
    <div class="top-cards">
      <div class="card">
        <h3>B.Sc</h3>
        <div class="semester-list" id="bscList"></div>
      </div>
      <div class="card">
        <h3>B.A.</h3>
        <div class="semester-list" id="baList"></div>
      </div>
      <div class="card">
        <h3>B.Com</h3>
        <div class="semester-list" id="bcomList"></div>
      </div>
    </div>

    <div id="studentTable" class="table-wrap">
      <h3>Available Notes & YouTube Links</h3>
      <table id="coursesTable" aria-describedby="List of uploaded entries">
        <thead>
          <tr><th>Course</th><th>Semester</th><th>Subject</th><th>YouTube</th><th>Uploaded At</th></tr>
        </thead>
        <tbody id="coursesBody"><tr><td colspan="5" class="note">Loading...</td></tr></tbody>
      </table>
    </div>
  </section>
</main>

<footer style="text-align:center;padding:12px;background:var(--card);color:var(--muted)">¬© 2025 PDUSU EDUCATION | Designed for Students</footer>

<div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
  <div class="modal" id="modalContent" role="dialog" aria-modal="true"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyADiTKwpQ2uW5DTo8lUp44TDAbSPQ3ntMQ",
  authDomain: "pdusu-education-4503b.firebaseapp.com",
  projectId: "pdusu-education-4503b",
  storageBucket: "pdusu-education-4503b.firebasestorage.app",
  messagingSenderId: "186812462719",
  appId: "1:186812462719:web:2108c8d68c12ff2b9f314a",
  measurementId: "G-4YT9MXGYWS"
};

const app = initializeApp(firebaseConfig);
try{ getAnalytics(app);}catch(e){}
const db = getFirestore(app);

const PASSWORD_SHA256 = "77cce9ae9209d01fb54c53a30b682af6815ffafb70174876013cb24436df2ca2"; // Pdusu123
const COLLECTION = "courses";

async function sha256Hex(input){
  const enc = new TextEncoder();
  const data = enc.encode(input);
  const hashBuffer = await crypto.subtle.digest("SHA-256", data);
  return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2,'0')).join('');
}
function esc(s){ return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function uuid(){ if(window.crypto && crypto.randomUUID) return crypto.randomUUID(); return 'id_'+Date.now(); }

const modalBackdrop = document.getElementById('modalBackdrop');
const modalContent = document.getElementById('modalContent');
function showModal(html){ modalContent.innerHTML = html; modalBackdrop.style.display = 'flex'; modalBackdrop.setAttribute('aria-hidden','false'); }
function closeModal(){ modalBackdrop.style.display = 'none'; modalBackdrop.setAttribute('aria-hidden','true'); }
modalBackdrop.addEventListener('click', (e)=>{ if(e.target===modalBackdrop) closeModal(); });
document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeModal(); });

const root = document.documentElement;
const themeToggle = document.getElementById('themeToggle');
function applyTheme(t){ if(t==='dark') root.setAttribute('data-theme','dark'); else root.removeAttribute('data-theme'); themeToggle.textContent = t==='dark'?'üåô Dark':'üåû Light'; localStorage.setItem('pdusu_theme', t); }
(function(){ const saved = localStorage.getItem('pdusu_theme')||'light'; applyTheme(saved); })();
themeToggle.addEventListener('click', ()=>{ const current = root.getAttribute('data-theme')==='dark' ? 'dark' : 'light'; applyTheme(current==='dark'?'light':'dark'); });

function renderSemesters(){
  const map = [{id:'bscList',label:'BSC'},{id:'baList',label:'BA'},{id:'bcomList',label:'BCOM'}];
  map.forEach(m=>{
    const el = document.getElementById(m.id);
    el.innerHTML = '';
    for(let i=1;i<=6;i++){
      const b = document.createElement('button');
      b.className='sem-btn';
      b.textContent = 'Sem ' + i;
      b.onclick = ()=> loadTable(m.label, i);
      el.appendChild(b);
    }
  });
}

async function fetchAllCourses(){
  const colRef = collection(db, COLLECTION);
  const q = query(colRef, orderBy('course'), orderBy('semester'));
  const snap = await getDocs(q);
  const items = [];
  snap.forEach(doc => {
    const d = doc.data();
    items.push({
      id: doc.id,
      course: d.course || '',
      semester: d.semester || 0,
      subject: d.subject || '',
      youtube: d.youtube || '',
      uploadedAt: d.uploadedAt ? d.uploadedAt.toDate ? d.uploadedAt.toDate() : new Date(d.uploadedAt) : null
    });
  });
  return items;
}

async function renderTable(items){
  const tbody = document.getElementById('coursesBody');
  if(!items || items.length===0){
    tbody.innerHTML = `<tr><td colspan="5" class="note">‡§ï‡•ã‡§à ‡§®‡•ã‡§ü ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</td></tr>`;
    return;
  }
  let html = '';
  items.forEach(it=>{
    html += `<tr>
      <td>${esc(it.course)}</td>
      <td>${esc(it.semester)}</td>
      <td>${esc(it.subject)}</td>
      <td>${it.youtube? `<a href="${esc(it.youtube)}" target="_blank">‚ñ∂Ô∏è Open</a>` : '-'}</td>
      <td>${it.uploadedAt ? esc(it.uploadedAt.toLocaleString()) : '-'}</td>
    </tr>`;
  });
  tbody.innerHTML = html;
}

async function loadAll(){
  const items = await fetchAllCourses();
  await renderTable(items);
}
async function loadTable(course, sem){
  const all = await fetchAllCourses();
  const filtered = all.filter(i => i.course.toUpperCase() === course.toUpperCase() && Number(i.semester) === Number(sem));
  await renderTable(filtered);
  document.getElementById('studentTable').scrollIntoView({behavior:'smooth'});
}

let clickCount = 0;
document.getElementById('logo').addEventListener('click', async ()=>{
  clickCount++;
  if(clickCount===3){
    clickCount=0;
    const pwd = prompt("Admin Password ‡§°‡§æ‡§≤‡•á‡§Ç:");
    if(!pwd) return;
    const h = await sha256Hex(pwd);
    if(h === PASSWORD_SHA256) openAdmin();
    else alert("Password ‡§ó‡§≤‡§§ ‡§π‡•à‡•§");
  }
  setTimeout(()=>clickCount=0,1500);
});

function openAdmin(){
  showModal(`
    <h2>Admin Panel ‚Äî Add Entry</h2>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <label style="flex:1">
        Course<br>
        <select id="admCourse"><option value="BSC">BSC</option><option value="BA">BA</option><option value="BCOM">BCOM</option></select>
      </label>
      <label style="flex:1">
        Semester<br>
        <select id="admSem"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select>
      </label>
    </div>
    <div style="margin-top:10px">
      <label>Subject name<br><input id="admSubject" type="text" placeholder="Subject name" style="width:100%;padding:8px;border-radius:8px;border:1px solid #eee"></label>
    </div>
    <div style="margin-top:10px">
      <label>YouTube Link (optional)<br><input id="admYouTube" type="url" placeholder="https://www.youtube.com/..." style="width:100%;padding:8px;border-radius:8px;border:1px solid #eee"></label>
    </div>
    <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap">
      <button class="btn btn-primary" id="uploadBtn">Save</button>
      <button class="btn btn-ghost" onclick="closeModal()">Close</button>
      <button class="btn btn-ghost" onclick="openList()">Manage Entries</button>
    </div>
    <hr>
    <div id="adminMsg" class="note"></div>
  `);

  document.getElementById('uploadBtn').onclick = handleUpload;
}

async function openList(){
  const items = await fetchAllCourses();
  let listHtml = '<div style="max-height:300px;overflow:auto">';
  if(items.length===0) listHtml += '<p class="note">‡§ï‡•ã‡§à ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§</p>';
  items.slice().reverse().forEach(it=>{
    listHtml += `<div style="padding:8px;border-bottom:1px solid rgba(0,0,0,0.04)">
      <strong>${esc(it.course)} Sem ${esc(it.semester)}</strong> ‚Äî ${esc(it.subject)}<br>
      ${it.youtube?`<a href="${esc(it.youtube)}" target="_blank">YouTube</a>`:''}
    </div>`;
  });
  listHtml += '</div>';
  showModal(`<h3>Existing Entries</h3>${listHtml}<div style="margin-top:10px"><button class="btn btn-ghost" onclick="openAdmin()">Back</button></div>`);
}

async function handleUpload(){
  const course = document.getElementById('admCourse').value;
  const sem = Number(document.getElementById('admSem').value);
  const subject = document.getElementById('admSubject').value.trim();
  const youtube = document.getElementById('admYouTube').value.trim();
  const adminMsg = document.getElementById('adminMsg');
  adminMsg.textContent = '';
  if(!subject){ adminMsg.textContent = '‡§ï‡•É‡§™‡§Ø‡§æ Subject name ‡§≠‡§∞‡•á‡§Ç'; return; }

  await addDoc(collection(db, COLLECTION), {
    course: course,
    semester: sem,
    subject: subject,
    youtube: youtube || '',
    uploadedAt: serverTimestamp()
  });

  adminMsg.textContent = 'Entry saved successfully!';
  document.getElementById('admSubject').value = '';
  document.getElementById('admYouTube').value = '';
  await loadAll();
  openList();
}

renderSemesters();
loadAll();
</script>
</body>
</html>
