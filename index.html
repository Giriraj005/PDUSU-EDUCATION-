<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽ“ PDUSU EDUCATION</title>
<style>
:root{--bg:#f8fafc;--card:#fff;--muted:#475569;--accent:#2563eb}
body{font-family:Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a;position:relative;min-height:100vh;}
header{display:flex;align-items:center;gap:12px;background:#fff;padding:16px;box-shadow:0 2px 6px rgba(0,0,0,.08);}
header img{height:60px;cursor:pointer}
header h1{margin:0;font-size:22px}
header p{margin:0;font-size:14px;color:var(--muted)}
nav{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;padding:15px;background:#e2e8f0}
button, .btn{padding:10px 20px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer;transition:.15s}
button:hover,.btn:hover{background:#1e40af}
.content{padding:20px;max-width:1200px;margin:0 auto}
.semester{display:none;animation:fade .25s ease}
@keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
.semester-columns{display:flex;gap:12px;margin-top:15px;flex-wrap:wrap}
.column{flex:1;background:var(--card);padding:16px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1);min-width:220px}
.column h3{margin-top:0;color:var(--accent)}
.class-card{background:#f1f5f9;border-radius:10px;padding:12px;margin-bottom:12px;box-shadow:0 2px 4px rgba(0,0,0,.08)}
.class-card a{color:var(--accent);text-decoration:none;font-weight:500}
footer{text-align:center;padding:20px;background:#e2e8f0;color:var(--muted);font-size:14px}
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:50}
.modal{background:#fff;border-radius:10px;padding:20px;width:90%;max-width:520px;box-shadow:0 8px 30px rgba(2,6,23,.2)}
label{display:block;margin-top:8px;font-size:14px}
input[type="text"],select,input[type="url"]{width:100%;padding:10px;border:1px solid #e6e9ef;border-radius:8px;margin-top:6px}
.admin-controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.danger{background:#ef4444}
.small{font-size:13px;padding:8px 10px;border-radius:6px}
.note{color:#6b7280;font-size:13px;margin-top:8px}
</style>
</head>
<body>

<header>
  <img id="logo" src="PDUSU-logo.png" alt="PDUSU Logo" onerror="this.style.opacity='.25'">
  <div>
    <h1>ðŸŽ“ PDUSU EDUCATION</h1>
    <p>Pandit Deendayal Upadhyaya Shekhawati University, Sikar</p>
  </div>
</header>

<nav>
  <button onclick="showSection('result')">ðŸ“Š Result</button>
  <button onclick="showSection('syllabus')">ðŸ“‘ Syllabus</button>
  <button onclick="showSection('news')">ðŸ“° University News</button>
  <button onclick="showSemester(1)">Semester 1</button>
  <button onclick="showSemester(2)">Semester 2</button>
  <button onclick="showSemester(3)">Semester 3</button>
  <button onclick="showSemester(4)">Semester 4</button>
  <button onclick="showSemester(5)">Semester 5</button>
  <button onclick="showSemester(6)">Semester 6</button>
</nav>

<div class="content">
  <div id="result" class="semester">
    <h2>ðŸ“Š Result</h2>
    <p><a href="https://shekhauniexam.in/" target="_blank">Click here to view results</a></p>
  </div>

  <div id="syllabus" class="semester">
    <h2>ðŸ“‘ Syllabus</h2>
    <p><a href="https://shekhauni.ac.in/Home/Syllabus" target="_blank">Click here to view syllabus</a></p>
  </div>

  <div id="news" class="semester">
    <h2>ðŸ“° University News</h2>
    <p><a href="https://shekhauni.ac.in/Home/Examination" target="_blank">Click here for university news</a></p>
  </div>

  <!-- Semester sections -->
  <div id="sem1" class="semester"><h2>ðŸ“˜ Semester 1</h2><div class="semester-columns"></div></div>
  <div id="sem2" class="semester"><h2>ðŸ“— Semester 2</h2><div class="semester-columns"></div></div>
  <div id="sem3" class="semester"><h2>ðŸ“™ Semester 3</h2><div class="semester-columns"></div></div>
  <div id="sem4" class="semester"><h2>ðŸ“’ Semester 4</h2><div class="semester-columns"></div></div>
  <div id="sem5" class="semester"><h2>ðŸ“• Semester 5</h2><div class="semester-columns"></div></div>
  <div id="sem6" class="semester"><h2>ðŸ“š Semester 6</h2><div class="semester-columns"></div></div>

</div>

<footer>Â© 2025 PDUSU EDUCATION | Designed for University Students</footer>

<!-- Admin modal -->
<div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-hidden="true">
  <div class="modal" role="document">
    <div id="modalContent"></div>
  </div>
</div>

<script>
// ---------- Config ----------
const PASSWORD_SHA256 = "8abf09e0892662c4b8945de98ac87f804fdf1bc1e8545ecebb570683a68b4928"; // 9828
const GITHUB_USERNAME = "Giriraj005";
const REPO_NAME = "pdusu-classes";
const FILE_PATH = "classes.json";
const BRANCH = "main";
const TOKEN = "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";
const RAW_JSON_URL = `https://raw.githubusercontent.com/${GITHUB_USERNAME}/${REPO_NAME}/main/${FILE_PATH}`;

// ---------- Helpers ----------
async function sha256Hex(input){
  const enc = new TextEncoder();
  const data = enc.encode(input);
  const hash = await crypto.subtle.digest("SHA-256", data);
  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
}
function escapeHtml(s){ return String(s).replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]); }
function escapeAttr(s){ return String(s||'').replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }

// ---------- Load classes ----------
async function loadClasses(){
  try {
    const res = await fetch(RAW_JSON_URL);
    const data = await res.json();
    return data.classes || [];
  } catch(e){
    console.error("Failed to fetch classes.json", e);
    return [];
  }
}

// ---------- Render ----------
async function renderAll(){
  const allClasses = await loadClasses();
  for(let s=1;s<=6;s++){
    const container=document.querySelector("#sem"+s+" .semester-columns");
    container.innerHTML="";
    const streams=["BA","BSc","B.Com"];
    streams.forEach(stream=>{
      const col=document.createElement("div"); col.className="column";
      col.innerHTML=`<h3>${stream}</h3>`;
      const items = allClasses.filter(c=>c.semester===s && c.stream===stream);
      if(items.length===0){ col.innerHTML+=`<p class='note'>No classes yet.</p>`; }
      items.forEach(it=>{
        const card=document.createElement("div"); card.className="class-card";
        let html="";
        if(it.class_name) html+=`<h4>${escapeHtml(it.class_name)}</h4>`;
        if(it.youtube_link) html+=`<p><a href="${escapeAttr(it.youtube_link)}" target="_blank">â–¶ YouTube</a></p>`;
        if(it.pdf_url) html+=`<p><a href="${escapeAttr(it.pdf_url)}" target="_blank">ðŸ“„ PDF</a></p>`;
        card.innerHTML = html;
        col.appendChild(card);
      });
      container.appendChild(col);
    });
  }
}

// ---------- Semester & Section ----------
function showSemester(n){ document.querySelectorAll(".semester").forEach(s=>s.style.display="none"); document.getElementById("sem"+n).style.display="block"; }
function showSection(name){ document.querySelectorAll(".semester").forEach(s=>s.style.display="none"); const el = document.getElementById(name); if(el) el.style.display='block'; }

showSemester(1);
renderAll();

// ---------- Admin via triple-click logo ----------
let clickCount=0;
document.getElementById('logo').addEventListener('click', async ()=>{
  clickCount++;
  if(clickCount===3){
    clickCount=0;
    const pwd=prompt("Enter Admin Password:");
    if(!pwd) return;
    const hash = await sha256Hex(pwd);
    if(hash===PASSWORD_SHA256) openAdminPanel();
    else alert("Incorrect password");
  }
  setTimeout(()=>clickCount=0,1500);
});

// ---------- Admin Panel ----------
const modalBackdrop=document.getElementById("modalBackdrop");
const modalContent=document.getElementById("modalContent");
function showModal(html){ modalContent.innerHTML=html; modalBackdrop.style.display="flex"; }
function closeModal(){ modalBackdrop.style.display="none"; }

async function pushClassesToGitHub(updatedData, commitMessage="Update classes"){
  try{
    // Get current file SHA
    const fileRes = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/${FILE_PATH}`,{
      headers:{Authorization:`token ${TOKEN}`}
    });
    const fileData = await fileRes.json();
    const sha = fileData.sha;

    // Commit new content
    const putRes = await fetch(`https://api.github.com/repos/${GITHUB_USERNAME}/${REPO_NAME}/contents/${FILE_PATH}`,{
      method:"PUT",
      headers:{"Authorization":`token ${TOKEN}`,"Content-Type":"application/json"},
      body: JSON.stringify({
        message: commitMessage,
        content: btoa(JSON.stringify({classes:updatedData}, null, 2)),
        sha: sha,
        branch: BRANCH
      })
    });
    const result = await putRes.json();
    console.log("GitHub update result:", result);
    alert("Classes updated successfully!");
    renderAll();
  }catch(e){console.error(e);alert("Failed to update GitHub file.");}
}

// Dummy Admin panel placeholder
function openAdminPanel(){
  alert("Admin panel opens here. You can add/edit/delete classes.\nAll changes will sync to GitHub automatically.");
}
</script>

</body>
</html>
