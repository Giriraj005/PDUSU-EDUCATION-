<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ЁЯОУ PDUSU EDUCATION</title>
<meta name="theme-color" content="#2563eb" />
<style>
:root{
  --bg:#f8fafc;--text:#0f172a;--card:#fff;--muted:#475569;--accent:#2563eb;--glass:rgba(255,255,255,0.6);
}
[data-theme="dark"]{--bg:#0b1220;--text:#e6eef8;--card:#0f1724;--muted:#94a3b8;--accent:#3b82f6;--glass:rgba(255,255,255,0.03)}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column}
header{display:flex;justify-content:space-between;align-items:center;padding:18px 22px;background:linear-gradient(90deg,#6366f1,#ec4899,#f59e0b);color:#fff}
.header-left{display:flex;gap:14px;align-items:center}
#logo{width:80px;height:80px;border-radius:10px;background:#fff;padding:6px;cursor:pointer;object-fit:cover;box-shadow:0 6px 18px rgba(0,0,0,0.12)}
.header-title h1{margin:0;font-size:20px}
.header-title p{margin:4px 0 0 0;font-size:13px;opacity:.95}
.theme-toggle{background:rgba(255,255,255,0.95);color:var(--accent);border:none;padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:700}
.main-wrap{width:95%;max-width:1200px;margin:20px auto;display:flex;gap:20px;flex-wrap:wrap;align-items:flex-start}
.sidebar{width:240px;min-width:200px;background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.06)}
.sidebar h3{margin:0 0 8px 0}
.link{display:block;text-align:center;background:var(--accent);color:#fff;padding:10px;border-radius:8px;margin:8px 0;text-decoration:none;font-weight:700}
.content{flex:1;min-width:300px}
.top-cards{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:12px}
.card{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.06);flex:1;min-width:220px}
.card h3{margin:0 0 8px 0;color:var(--accent)}
.semester-list{display:flex;gap:8px;flex-wrap:wrap}
.sem-btn{padding:8px 12px;border-radius:8px;border:none;background:#f1f5f9;color:var(--text);cursor:pointer;font-weight:700}
.sem-btn:hover{background:rgba(37,99,235,0.08)}
.note{font-size:13px;color:var(--muted);margin-top:8px}
.table-wrap{background:var(--card);padding:12px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,0.06);overflow:auto}
table{width:100%;border-collapse:collapse;font-size:14px}
thead th{position:sticky;top:0;background:var(--card);padding:10px;text-align:left;border-bottom:1px solid rgba(0,0,0,0.06)}
tbody td{padding:10px;border-bottom:1px solid rgba(0,0,0,0.04)}
.btn{padding:8px 10px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
.btn-primary{background:var(--accent);color:#fff}
.btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06)}
.progress{height:10px;background:#f1f5f9;border-radius:8px;overflow:hidden;margin-top:6px}
.progress > i{display:block;height:100%;background:var(--accent);width:0%}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:none;align-items:center;justify-content:center;z-index:200}
.modal{background:var(--card);width:92%;max-width:720px;border-radius:12px;padding:18px;box-shadow:0 20px 60px rgba(2,6,23,0.4);max-height:86vh;overflow:auto}
@media(max-width:900px){.main-wrap{padding:0 12px}.sidebar{width:100%}.top-cards{flex-direction:column}}
</style>
</head>
<body>

<header>
  <div class="header-left">
    <img id="logo" src="PDUSU-logo.png" alt="PDUSU Logo">
    <div class="header-title">
      <h1>ЁЯОУ PDUSU EDUCATION</h1>
      <p>рдореЗрд╣рдирдд рд╣реА рд╕рдлрд▓рддрд╛ рдХреА рдХреБрдВрдЬреА рд╣реИ тАФ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд░рд╣реЛ, рдЫрд╛рддреНрд░реЛ!</p>
    </div>
  </div>
  <div>
    <button id="themeToggle" class="theme-toggle" aria-label="Toggle theme">ЁЯМЮ Light</button>
  </div>
</header>

<main class="main-wrap">
  <aside class="sidebar" aria-label="Useful links">
    <h3>рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд┐рдВрдХреНрд╕</h3>
    <a class="link" href="https://shekhauniexam.in/" target="_blank">ЁЯУД Result</a>
    <a class="link" href="https://shekhauni.ac.in/Home/Syllabus" target="_blank">ЁЯУШ Syllabus</a>
    <a class="link" href="https://shekhauni.ac.in/Home/Examination" target="_blank">ЁЯУ░ University News</a>
    <a class="link" href="https://www.youtube.com/" target="_blank">тЦ╢я╕П YouTube</a>
  </aside>

  <section class="content">
    <div class="top-cards">
      <div class="card"><h3>B.Sc</h3><div class="semester-list" id="bscList"></div></div>
      <div class="card"><h3>B.A.</h3><div class="semester-list" id="baList"></div></div>
      <div class="card"><h3>B.Com</h3><div class="semester-list" id="bcomList"></div></div>
    </div>

    <div id="studentTable" class="table-wrap">
      <h3>Available Notes & PDFs</h3>
      <table id="coursesTable">
        <thead><tr><th>Course</th><th>Semester</th><th>Subject</th><th>YouTube</th><th>PDF</th><th>Uploaded At</th></tr></thead>
        <tbody id="coursesBody"><tr><td colspan="6" class="note">Loading...</td></tr></tbody>
      </table>
    </div>
  </section>
</main>

<footer style="text-align:center;padding:12px;background:var(--card);color:var(--muted)">┬й 2025 PDUSU EDUCATION | Designed for Students</footer>

<div id="modalBackdrop" class="modal-backdrop"><div class="modal" id="modalContent"></div></div>

<script type="module">
// ЁЯФе Firebase Config (рддреБрдореНрд╣рд╛рд░рд╛ рдирдпрд╛ рд╡рд╛рд▓рд╛)
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
import { getStorage, ref as storageRef, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyBiRACgJgwPcn-6t2pFHpOMgYwYhu2eHgM",
  authDomain: "pdusu-edu.firebaseapp.com",
  projectId: "pdusu-edu",
  storageBucket: "pdusu-edu.appspot.com",
  messagingSenderId: "1049889029840",
  appId: "1:1049889029840:web:156d84270f60016174a8d5",
  measurementId: "G-KG0E4QNY9Z"
};
const app = initializeApp(firebaseConfig);
try{ getAnalytics(app); }catch(e){}
const db = getFirestore(app);
const storage = getStorage(app);

const PASSWORD_SHA256 = "77cce9ae9209d01fb54c53a30b682af6815ffafb70174876013cb24436df2ca2"; // Pdusu123
const COLLECTION = "courses";

async function sha256Hex(input){const d=new TextEncoder().encode(input);const h=await crypto.subtle.digest("SHA-256",d);return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('');}
function esc(s){return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));}
function uuid(){return crypto.randomUUID ? crypto.randomUUID() : 'id_'+Date.now();}

const modalBackdrop=document.getElementById('modalBackdrop');
const modalContent=document.getElementById('modalContent');
function showModal(html){modalContent.innerHTML=html;modalBackdrop.style.display='flex';}
function closeModal(){modalBackdrop.style.display='none';}
modalBackdrop.addEventListener('click',e=>{if(e.target===modalBackdrop)closeModal();});

const root=document.documentElement;
const themeToggle=document.getElementById('themeToggle');
function applyTheme(t){if(t==='dark')root.setAttribute('data-theme','dark');else root.removeAttribute('data-theme');themeToggle.textContent=t==='dark'?'ЁЯМЩ Dark':'ЁЯМЮ Light';localStorage.setItem('pdusu_theme',t);}
(function(){const s=localStorage.getItem('pdusu_theme')||'light';applyTheme(s);})();
themeToggle.addEventListener('click',()=>{const c=root.getAttribute('data-theme')==='dark'?'dark':'light';applyTheme(c==='dark'?'light':'dark');});

function renderSemesters(){
  const map=[{id:'bscList',label:'BSC'},{id:'baList',label:'BA'},{id:'bcomList',label:'BCOM'}];
  map.forEach(m=>{
    const el=document.getElementById(m.id);el.innerHTML='';
    for(let i=1;i<=6;i++){const b=document.createElement('button');b.className='sem-btn';b.textContent='Sem '+i;b.onclick=()=>loadTable(m.label,i);el.appendChild(b);}
  });
}

async function fetchAllCourses(){
  const q=query(collection(db,COLLECTION),orderBy('course'),orderBy('semester'));
  const snap=await getDocs(q);const items=[];
  snap.forEach(doc=>{const d=doc.data();items.push({
    id:doc.id,course:d.course||'',semester:d.semester||0,subject:d.subject||'',youtube:d.youtube||'',pdf:d.pdfUrl||'',uploadedAt:d.uploadedAt?.toDate?.()||null
  });});
  return items;
}

async function renderTable(items){
  const tbody=document.getElementById('coursesBody');
  if(!items.length){tbody.innerHTML=`<tr><td colspan="6" class="note">рдХреЛрдИ рдиреЛрдЯ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИред</td></tr>`;return;}
  tbody.innerHTML=items.map(it=>`<tr>
    <td>${esc(it.course)}</td><td>${esc(it.semester)}</td><td>${esc(it.subject)}</td>
    <td>${it.youtube?`<a href="${esc(it.youtube)}" target="_blank">тЦ╢я╕П</a>`:'-'}</td>
    <td>${it.pdf?`<a href="${esc(it.pdf)}" target="_blank" class="btn btn-primary">ЁЯУе Download</a>`:'-'}</td>
    <td>${it.uploadedAt?esc(it.uploadedAt.toLocaleString()):'-'}</td></tr>`).join('');
}

async function loadAll(){renderTable(await fetchAllCourses());}
async function loadTable(course,sem){const all=await fetchAllCourses();renderTable(all.filter(i=>i.course.toUpperCase()===course.toUpperCase()&&+i.semester===+sem));}

let clickCount=0;
document.getElementById('logo').addEventListener('click',async()=>{clickCount++;if(clickCount===3){clickCount=0;const pwd=prompt("Admin Password рдбрд╛рд▓реЗрдВ:");if(!pwd)return;const h=await sha256Hex(pwd);if(h===PASSWORD_SHA256)openAdmin();else alert("Password рдЧрд▓рдд рд╣реИред");}setTimeout(()=>clickCount=0,1500);});

function openAdmin(){
  showModal(`
    <h2>Admin Panel тАФ Upload PDF</h2>
    <div><label>Course<select id="admCourse"><option>BSC</option><option>BA</option><option>BCOM</option></select></label></div>
    <div><label>Semester<select id="admSem"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></label></div>
    <div><label>Subject<input id="admSubject" type="text" style="width:100%"></label></div>
    <div><label>YouTube Link (optional)<input id="admYouTube" type="url" style="width:100%"></label></div>
    <div><label>PDF File<input id="admPdfFile" type="file" accept="application/pdf" style="width:100%"></label>
    <div class="progress" style="display:none"><i></i></div></div>
    <button id="uploadBtn" class="btn btn-primary">Upload & Save</button>
    <button class="btn btn-ghost" onclick="closeModal()">Close</button>
    <div id="adminMsg" class="note"></div>
  `);
  document.getElementById('uploadBtn').onclick=handleUpload;
}

async function handleUpload(){
  const c=document.getElementById('admCourse').value;
  const s=+document.getElementById('admSem').value;
  const subj=document.getElementById('admSubject').value.trim();
  const yt=document.getElementById('admYouTube').value.trim();
  const f=document.getElementById('admPdfFile').files[0];
  const msg=document.getElementById('adminMsg');
  if(!subj)return msg.textContent='рдХреГрдкрдпрд╛ Subject рдбрд╛рд▓реЗрдВ';
  if(!f)return msg.textContent='рдХреГрдкрдпрд╛ PDF рдЪреБрдиреЗрдВ';
  const progress=modalContent.querySelector('.progress');progress.style.display='block';
  const bar=progress.querySelector('i');
  const path=`courses/${c}/sem${s}/${uuid()}.pdf`;
  const sRef=storageRef(storage,path);
  const uploadTask=uploadBytesResumable(sRef,f);
  uploadTask.on('state_changed',snap=>{bar.style.width=(snap.bytesTransferred/snap.totalBytes*100)+'%';},err=>msg.textContent=err.message,async()=>{
    const url=await getDownloadURL(uploadTask.snapshot.ref);
    await addDoc(collection(db,COLLECTION),{course:c,semester:s,subject:subj,youtube:yt,pdfUrl:url,uploadedAt:serverTimestamp()});
    msg.textContent='тЬЕ Uploaded Successfully!';loadAll();
  });
}
renderSemesters();loadAll();
</script>
</body>
</html>
